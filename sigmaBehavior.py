import matplotlib.pyplot as plt
import numpy as np

sigmas1 = np.array([
    12.520653814999466,
    26.938830192854105,
    16.051911333587626,
    12.296071107325709,
    7.035737028722147,
    19.578897201213003,
    7.5019544436201215,
    60.74996073425695,
    84.59126528049376,
    5.846326121643413,
    1.345853577688474,
    93.7144938415643,
    80.45564515992577,
    44.648724300188675,
    44.59388678508123,
    41.90688195225874,
    3.461751661573063,
    63.9366094328724,
    27.03662853590898,
    97.2385413047191
])

losses1 = np.array([
    0.008186852559447289,
    0.004667649976909161,
    0.005996975116431713,
    0.008429286070168018,
    0.01086925994604826,
    0.005400161258876324,
    0.010875944048166275,
    0.0035944951232522726,
    0.0035759094171226025,
    0.011827307753264904,
    0.373460054397583,
    0.00387345883063972,
    0.0035969666205346584,
    0.00393301248550415,
    0.003995569422841072,
    0.004062913358211517,
    0.016506433486938477,
    0.0036414950154721737,
    0.004782198928296566,
    0.0037970873527228832
])

sigmas2 = np.array([
    107.00120234083903, 
    134.75872957290457, 
    115.31072887483366, 
    106.41978293721805, 
    89.95713371512852, 
    122.41566846896805, 
    91.71149161373727, 
    172.13566016258588, 
    190.1747252826332, 
    85.07947509745648, 
    51.42953245154858, 
    196.12952923790107,
    187.3266970983376, 
    156.89605251912673, 
    158.7288594179992, 
    197.96574847864076, 
    72.66315479667071, 
    153.44015955346987, 
    137.08913728407026, 
    137.13995373271584,
    249.84534170484113,
    267.2813102775373,
    255.37087083741162,
    249.44750325276428,
    237.48265887897398,
    259.87607763911365,
    238.82802027488165,
    287.119987331902,
    295.61235717788867,
    233.64188180483345,
    205.2994043614781,
    222.26986174982846,
    220.08095524298236,
    219.7116430778307,
    225.41093678914504,
    202.4302087409161,
    231.6957400682845,
    269.7375025841362,
    214.17968964874146,
    210.36672659891784 
])

losses2 = np.array([
    5.7314333389513195e-05, 
    3.1360817956738174e-05, 
    3.621327778091654e-05, 
    4.3258722143946216e-05, 
    3.368933903402649e-05, 
    4.390575850266032e-05, 
    9.132349805440754e-05, 
    2.3479447918361984e-05, 
    2.4206743546528742e-05, 
    8.336835162481293e-05, 
    3.17984726279974e-04,  
    2.179472903662827e-05, 
    3.259153163526207e-05, 
    3.111629484919831e-05, 
    2.4771896278252825e-05, 
    2.567382762208581e-05, 
    1.3277068501338363e-04, 
    2.5514607841614634e-05, 
    2.256559491797816e-05, 
    3.4896849683718756e-05,
    2.6426771000842564e-05,
    2.312719516339712e-05,
    2.102183316310402e-05,
    2.084074185404461e-05,
    1.2354651516943704e-05,
    2.8516802558442578e-05,
    2.8518068575067446e-05,
    2.5537297915434465e-05,
    3.398993794689886e-05,
    2.545927418395877e-05,
    2.572926678112708e-05,
    2.053650314337574e-05,
    2.499736365280114e-05,
    2.469512037350796e-05,
    1.9515937310643494e-05,
    2.581006265245378e-05,
    2.4530319933546707e-05,
    2.307223439856898e-05,
    1.4507153537124395e-05,
    2.494037471478805e-05 
])

idx1 = np.argsort(sigmas1)   

sigmas1 = sigmas1[idx1]
losses1 = losses1[idx1]

idx2 = np.argsort(sigmas2)   # indices that sort sigmas

sigmas2 = sigmas2[idx2]
losses2 = losses2[idx2]

plt.figure(figsize=(6, 4))
plt.scatter(sigmas1, losses1)
plt.plot(sigmas1, losses1, color="red", label="sgd", alpha=0.5)
plt.scatter(sigmas2, losses2)
plt.plot(sigmas2, losses2, color="blue", label="adam", alpha=0.5)
plt.yscale("log")
plt.xlabel(r"$\sigma$")
plt.ylabel("Loss")
plt.title("Optuna search: Loss vs $\sigma$")
plt.grid(True, which="both", linestyle="--", alpha=0.4)
plt.legend()
plt.tight_layout()
plt.show()


################################################## super ############################################


import numpy as np

sigmas1 = np.array([
    12.520653814999466,   # 0
    26.938830192854105,   # 1
    16.051911333587626,   # 2
    12.296071107325709,   # 3
    7.035737028722147,    # 4
    19.578897201213003,   # 5
    7.5019544436201215,   # 6
    60.74996073425695,    # 7
    84.59126528049376,    # 8
    5.846326121643413,    # 9
    1.0981684015202464,   # 10
    59.61673371095738,   # 11
    80.45564515992577,   # 12
    38.72485999854677,   # 13
    41.78153572096715,   # 14
    32.23121008796371,   # 15
    3.461751661573063,   # 16
    42.05438674930875,   # 17
    41.41220773565744,   # 18
    22.52470371702137    # 19  
])

losses1 = np.array([
    0.0037475789431482553,  # 0
    0.0026162266731262207,  # 1
    0.003227317938581109,   # 2
    0.004152769688516855,   # 3
    0.007184943184256554,   # 4
    0.002924942411482334,   # 5
    0.00693443464115262,    # 6
    0.0025022896006703377, # 7
    0.0033824313431978226, # 8
    0.008396340534090996,  # 9
    0.023455344140529633,  # 10
    0.0025514252483844757, # 11
    0.0031955051235854626, # 12
    0.002423373516649008,  # 13
    0.002496308647096157,  # 14
    0.00250469078309834,   # 15
    0.013039516285061836,  # 16
    0.0023825871758162975, # 17  ← best
    0.0025008306838572025, # 18
    0.00282640615478158,    # 19

])

sigmas2 = np.array([
    89.13376857339883,    # 0
    135.72147242714485,   # 1
    50.007928486759546,   # 2
    76.03128847689648,    # 3
    61.281001562174495,   # 4
    56.8281316513089,     # 5
    64.73062876467897,    # 6
    80.72690320375924,    # 7
    86.66581519533162,    # 8
    105.52855770718365,  # 9
    159.0089873265695,   # 10
    130.5349625719157,   # 11
    136.84321562035132,  # 12
    196.60668318624175,  # 13
    120.76634094844664,  # 14
    115.21536371023774,  # 15
    126.51288348692438,  # 16
    168.3646780350862,   # 17
    178.80203382494832,  # 18
    197.816286857656,     # 19
    236.8448389522633,
    267.8384004250336,
    200.00927521460315,
    226.08311017198696,
    212.2620846899948,
    207.6299575057511,
    215.68939426918715,
    230.08071544955138,
    234.90771464574792,
    248.83468289454467,
    289.49389785316356,
    217.53654372169282,
    221.76407457731997,
    258.6534780822148,
    201.32372912182365,
    205.4055683095149,
    211.86914188543085,
    200.7027602079499,
    244.67157589015844,
    288.6747726334073
])

losses2 = np.array([
    1.4979152183514088e-04,  # 0
    1.2447680637706070e-04,  # 1
    2.4059918359853327e-04,  # 2
    1.5784468268975616e-04,  # 3
    1.6533133748453110e-04,  # 4
    2.2874114802107215e-04,  # 5
    2.3550857440568507e-04,  # 6
    1.6758099081926048e-04,  # 7
    1.5340662503149360e-04,  # 8
    1.4025285781826824e-04,  # 9
    1.4415026817005128e-04,  # 10
    1.1516253289300948e-04,  # 11
    1.3773223327007145e-04,  # 12
    1.4215878036338836e-04,  # 13
    1.0270802158629522e-04,  # 14
    1.3243568537291140e-04,  # 15
    1.3915577437728643e-04,  # 16
    1.1446618009358644e-04,  # 17
    9.6513897005934270e-05,  # 18  ← best
    1.3740335998591036e-04,   # 19
    0.00014580394781660289,
    0.0001662762660998851,
    0.00012150021939305589,
    0.00012006027100142092,
    0.00010632620251271874,
    0.00014899020607117563,
    0.00016178148507606238,
    0.00015220280329231173,
    0.00013919042248744518,
    0.00015217902546282858,
    0.0001847078383434564,
    0.00012963396147824824,
    0.00014541538257617503,
    0.00016024158685468137,
    0.00011518263636389747,
    0.00013564203982241452,
    0.00014106891467235982,
    0.00011518890096340328,
    0.00011701892799464986,
    0.00017285272770095617
])


idx1 = np.argsort(sigmas1)   

sigmas1 = sigmas1[idx1]
losses1 = losses1[idx1]

idx2 = np.argsort(sigmas2)   # indices that sort sigmas

sigmas2 = sigmas2[idx2]
losses2 = losses2[idx2]

plt.figure(figsize=(6, 4))
plt.scatter(sigmas1, losses1)
plt.plot(sigmas1, losses1, color="red", label="sgd", alpha=0.5)
plt.scatter(sigmas2, losses2)
plt.plot(sigmas2, losses2, color="blue", label="adam", alpha=0.5)
plt.yscale("log")
plt.xlabel(r"$\sigma$")
plt.ylabel("Loss")
plt.title("Optuna search: Loss vs $\sigma$")
plt.grid(True, which="both", linestyle="--", alpha=0.4)
plt.legend()
plt.tight_layout()
plt.show()



sigmas1 = np.array([
    12.520653814999466,   # 0
    26.938830192854105,   # 1
    16.051911333587626,   # 2
    12.296071107325709,   # 3
    7.035737028722147,    # 4
    19.578897201213003,   # 5
    7.5019544436201215,   # 6
    60.74996073425695,   # 7
    84.59126528049376,   # 8
    5.846326121643413,   # 9
    1.0981684015202464,  # 10
    93.7144938415643,    # 11
    80.45564515992577,   # 12
    44.648724300188675,  # 13
    43.69242743346912,   # 14
    55.61270409393887,   # 15
    3.461751661573063,   # 16
    38.82815505735124,   # 17
    98.38480342569895,   # 18
    25.202958341646074   # 19
])

losses1 = np.array([
    0.009635730646550655,  # 0
    0.006691333372145891,  # 1
    0.007550437934696674,  # 2
    0.010152437724173069, # 3
    0.017538046464323997, # 4
    0.007182093802839518, # 5
    0.016863146796822548, # 6
    0.005804959684610367, # 7  ← best
    0.006042125169187784, # 8
    0.02065202035009861,  # 9
    0.325409471988678,    # 10
    0.0059958091005682945,# 11
    0.0059163011610507965,# 12
    0.006087090820074081, # 13
    0.006109504494816065, # 14
    0.005972826387733221, # 15
    0.034391794353723526, # 16
    0.00622960040345788,  # 17
    0.006165469530969858, # 18
    0.006845199968665838  # 19
])

sigmas2 = np.array([
    91.50927010243544,    # 0
    51.82975444116563,    # 1
    107.12720916659566,   # 2
    91.4239961177457,    # 3
    89.54815444292039,   # 4
    79.04081029281095,   # 5
    66.40193866416837,   # 6
    117.97996879552194,  # 7
    75.74955651814184,   # 8
    72.37957543179233,   # 9
    170.06552974531832,  # 10
    161.15540457877623,  # 11
    179.1741068459557,   # 12
    193.41065188130938,  # 13
    140.5144821101171,   # 14
    199.52607592187027,  # 15
    141.90592681941078,  # 16
    144.86677599497955,  # 17
    146.41178802266907,  # 18  ← best
    125.16723265041841,   # 19
    238.67387651062356,
    202.1135258999927,
    249.93136059993006,
    238.60880399398934,
    237.1663616716759,
    228.66467073562237,
    217.30355501579137,
    257.08586544083454,
    225.8377635761272,
    222.8516974774813,
    286.105737979298,
    268.9852731350784,
    209.72174133063032,
    265.43499673757066,
    230.80262329312325,
    246.3258314070276,
    215.00754371904898,
    283.1378281631556,
    202.39539972127116,
    200.1436466562325
])

losses2 = np.array([
    6.52858114335686e-04,   # 0
    9.698336943984032e-04,  # 1
    5.853145266883075e-04,  # 2
    6.222592201083899e-04,  # 3
    6.222159136086702e-04,  # 4
    6.865087780170143e-04,  # 5
    8.136607357300818e-04,  # 6
    5.725433002226055e-04,  # 7
    7.012377609498799e-04,  # 8
    7.286201580427587e-04,  # 9
    5.524099105969071e-04,  # 10
    5.443067639134824e-04,  # 11
    5.519069381989539e-04,  # 12
    5.504230502992868e-04,  # 13
    5.527714383788407e-04,  # 14
    5.560123245231807e-04,  # 15
    5.596622941084206e-04,  # 16
    5.445515853352845e-04,  # 17
    5.250597605481744e-04,  # 18
    5.764063098467886e-04,   # 19
    0.0005686847143806517,
    0.0005496647791005671,
    0.0005541231366805732,
    0.0005467348964884877,
    0.0005661126342602074,
    0.0005698531749658287,
    0.0005710944533348083,
    0.0005838786019012332,
    0.0005473955534398556,
    0.0005607345956377685,
    0.0006141418707557023,
    0.0005878463853150606,
    0.0005551112699322402,
    0.0005893112393096089,
    0.0005727405659854412,
    0.0005764032830484211,
    0.0005527265020646155,
    0.0005910003092139959,
    0.0005176259437575936,
    0.0005552236689254642
])


idx1 = np.argsort(sigmas1)   

sigmas1 = sigmas1[idx1]
losses1 = losses1[idx1]

idx2 = np.argsort(sigmas2)   # indices that sort sigmas

sigmas2 = sigmas2[idx2]
losses2 = losses2[idx2]

plt.figure(figsize=(6, 4))
plt.scatter(sigmas1, losses1)
plt.plot(sigmas1, losses1, color="red", label="sgd", alpha=0.5)
plt.scatter(sigmas2, losses2)
plt.plot(sigmas2, losses2, color="blue", label="adam", alpha=0.5)
plt.yscale("log")
plt.xlabel(r"$\sigma$")
plt.ylabel("Loss")
plt.title("Optuna search: Loss vs $\sigma$")
plt.grid(True, which="both", linestyle="--", alpha=0.4)
plt.legend()
plt.tight_layout()
plt.show()